language: cpp

compiler:
    - clang

os:
    - linux

env:
    global:
    - CC=clang-3.8
    - CXX=clang++-3.8
    matrix:
    - ARCH=i386
    - ARCH=x86_64

addons:
  apt:
    packages:
        - gcc-multilib
        - flex
        - bison
        - qemu
        - expect
        - llvm-toolchain-precise-3.8

install:
    - mkdir deps && cd deps
    - git clone git://git.savannah.gnu.org/grub.git && cd grub
    - ./autogen.sh 
    - ./configure 
    - make -j2
    - cd ../../
    - PATH=$(pwd)/deps/grub/:$PATH
    - export PATH 

script:
    make -j2 && test/is_multiboot.sh && expect test/test.expect

cache:
    apt: true